const htmlparser = require("htmlparser");
const printer = require("./printer.js");

const handler = new htmlparser.DefaultHandler(
  function(error, dom) {
    if (error) {
      console.log(error);
      exit(1);
    }
  },
  { verbose: true, ignoreWhitespace: true, enforceEmptyTags: true }
);

function prettierHtml(html) {
  const parser = new htmlparser.Parser(handler);
  parser.parseComplete(html);
  //  console.log(JSON.stringify(handler.dom, null, 2));
  return handler.dom.map(e => printer(e, 0)).join("");
}

module.exports = prettierHtml;
